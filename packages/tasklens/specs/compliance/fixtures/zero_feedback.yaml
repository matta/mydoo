# yaml-language-server: $schema=../schemas/test_case.schema.json
name: Zero Feedback Deviation Cap
description:
  Verify that when actual credits are 0, the feedback multiplier is capped at
  Max Deviation Multiplier (1000.0) ^ K.

initial_state:
  current_time: "2023-01-01T12:00:00+00:00"
  timezone_offset: 0
  tasks:
    - id: ZeroRoot
      title: Zero Credits Root
      desired_credits: 100.0
      credits: 0.0
      children:
        - id: Child
          title: Worker
          importance: 1.0

steps:
  - name: Verify Feedback Cap
    expected_order: ["Child"]
    expected_props:
      - id: Child
        # Logic:
        # Target% = 1.0 (100/100)
        # Actual% = 0.0 (0/0) -> Floored to 1/1000 = 0.001
        # Deviation = 1.0 / 0.001 = 1000.0
        # Factor = 1000.0 ^ 2.0 = 1,000,000.0
        # Priority = Visibility(1) * GlobalImp(1.0) * RootFactor(1,000,000) * LeadTime(1.0)
        # Expect roughly 1,000,000
        score: 1000000.0
