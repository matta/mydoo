{
  "feature": "Sorting Importance Tiebreaker",
  "description": "Validates that when two tasks have equal computed priority, the sort falls\nback to raw importance (higher importance first) before using outline index.\n",
  "scenarios": [
    {
      "name": "Equal priority tasks are sorted by importance",
      "description": "Two root tasks with different importance values but equal computed priority\nshould be sorted by importance (descending), not outline order.\n\nWHY DUE DATES ARE NECESSARY:\nThe priority formula is: priority = importance Ã— lead_time_factor.\nTasks without due dates get lead_time_factor=1.0, so priority=importance.\nThis means equal priorities would require equal importance values, making\nit impossible to test the importance tiebreaker. By using due dates to\ntune lead_time_factor, we can achieve equal priorities (0.3) with different\nimportance values (0.6 vs 0.3), which exercises the tiebreaker logic.\n\nSETUP:\n- Task \"low-importance\": importance=0.3, overdue => factor=1.0 => priority=0.3\n- Task \"high-importance\": importance=0.6, factor=0.5 => priority=0.3\n\nExpected: high-importance comes first (importance 0.6 > 0.3)\n",
      "steps": [
        {
          "given": {
            "current_time": "2025-01-15T12:00:00Z",
            "tasks": [
              {
                "id": "low-importance",
                "title": "Low Importance Task",
                "desired_credits": 0,
                "lead_time_seconds": 604800,
                "importance": 0.3,
                "due_date": "2025-01-14T12:00:00Z"
              },
              {
                "id": "high-importance",
                "title": "High Importance Task",
                "desired_credits": 0,
                "lead_time_seconds": 604800,
                "importance": 0.6,
                "due_date": "2025-01-26T00:00:00Z"
              }
            ]
          },
          "then": {
            "expected_props": [
              {
                "id": "low-importance",
                "score": 0.3,
                "importance": 0.3
              },
              {
                "id": "high-importance",
                "score": 0.3,
                "importance": 0.6
              }
            ],
            "expected_order": [
              "high-importance",
              "low-importance"
            ]
          }
        }
      ]
    }
  ]
}
